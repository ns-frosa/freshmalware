from importlib.resources import path
from openpyxl import Workbook
from flask import Flask
from flask import send_file
import random

def createfreshmalware():
    workbook = Workbook()
    sheet = workbook.active

    num = random.randint(1,999999999)

    sheet["A1"] = "This is an automatically generated file"
    sheet["A2"] = "Meant to be used in Netskope Demos to show the patient-0 alerting and policy functionality"
    sheet['A3'] = "Keep in mind this file will only trigger Netskope engines and no other security tool will detect it"
    sheet['A4'] = 'URL: http://itrad3r.com/mine/Panel/PvqDq929BSx_A_D_M1n_a.php'
    sheet['A5'] = 'The random number below is what makes the file unique and it matches the filename for easy verification'
    sheet['A6'] = num

    fname = "ns_freshmalware_" + str(num) + ".xlsx"
    fullpath = "./samples/" + fname

    workbook.save(filename=fullpath)

    return fname

app = Flask(__name__)

@app.route('/')
def index():
    return "you can download your fresh malware by clicking here!"

@app.route('/get', methods=['GET'])
def download():
    name = createfreshmalware()
    path = "./samples/" + name
    return send_file(path, as_attachment=True)
  

app.run(host='0.0.0.0', port=8080)



